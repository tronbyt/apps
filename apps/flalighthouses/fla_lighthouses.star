"""
Applet: FLA Lighthouses
Summary: Displays Florida lighhouses
Description: Displays Florida Lighhouse locations.
Author: Robert Ison
"""

load("images/lighthouse.gif", LIGHTHOUSE_GIF_ASSET = "file")
load("math.star", "math")
load("render.star", "render")
load("schema.star", "schema")

LIGHTHOUSE_GIF = LIGHTHOUSE_GIF_ASSET.readall()

MAP_PIXEL_SIZE = [45, 30]

FLORIDA_MAP = [[-85.156415, 29.679628], [-85.137397, 29.684348], [-85.134639, 29.686569], [-85.114268, 29.688658], [-85.093902, 29.684838], [-85.083719, 29.679019], [-85.077237, 29.670862], [-85.091399, 29.648634], [-85.097218, 29.633004], [-85.124913, 29.628433], [-85.142746, 29.635404], [-85.16252, 29.650282], [-85.18453, 29.663987], [-85.204314, 29.672695], [-85.222546, 29.678039], [-85.220324, 29.680138], [-85.208981, 29.681775], [-84.777208, 29.707398], [-84.729836, 29.738881], [-84.716994, 29.749066], [-84.696726, 29.76993], [-84.694125, 29.764593], [-84.694939, 29.761844], [-84.713747, 29.74139], [-84.765117, 29.699724], [-84.776954, 29.692191], [-84.799129, 29.681565], [-84.853829, 29.66472], [-84.884632, 29.652248], [-84.957779, 29.612635], [-85.036219, 29.588919], [-85.051033, 29.586928], [-84.932592, 29.637232], [-84.925842, 29.644949], [-84.920333, 29.648638], [-84.895885, 29.657444], [-84.862099, 29.672572], [-84.813352, 29.687028], [-84.79816, 29.699321], [-84.777208, 29.707398], [-82.821585, 27.964443], [-82.829801, 27.968469], [-82.828625, 28.019795], [-82.823025, 28.030695], [-82.823063, 28.044758], [-82.826282, 28.05345], [-82.831825, 28.062893], [-82.836326, 28.073193], [-82.837439, 28.07973], [-82.835425, 28.094841], [-82.478063, 27.92768], [-82.489817, 27.9196], [-82.491117, 27.9145], [-82.487417, 27.895001], [-82.48142, 27.889097], [-82.481763, 27.878098], [-82.487883, 27.872072], [-82.488057, 27.863566], [-82.480137, 27.853246], [-82.471624, 27.847342], [-82.553946, 27.848462], [-82.552918, 27.862702], [-82.538618, 27.864901], [-82.539318, 27.885001], [-82.542818, 27.890601], [-82.541747, 27.893706], [-82.541218, 27.948998], [-82.553918, 27.966998], [-82.576003, 27.969424], [-82.60865, 27.983245], [-82.62959, 27.998474], [-82.641487, 27.999426], [-82.664806, 27.997046], [-82.678606, 27.993715], [-82.682414, 27.987053], [-82.684793, 27.971824], [-82.700134, 27.960307], [-82.724122, 27.948098], [-82.720122, 27.936399], [-82.710022, 27.928299], [-82.691621, 27.924899], [-82.685121, 27.916299], [-82.671221, 27.913], [-82.62572, 27.727006], [-82.63362, 27.710607], [-82.63982, 27.703907], [-82.652521, 27.700307], [-82.662921, 27.702307], [-82.671621, 27.705907], [-82.677321, 27.706207], [-82.679251, 27.694665], [-82.693748, 27.700217], [-82.713629, 27.698661], [-82.718822, 27.692007], [-82.723022, 27.671208], [-82.721622, 27.663908], [-82.716322, 27.651409], [-82.712555, 27.646647], [-82.698091, 27.638858], [-82.733076, 27.612972], [-82.736552, 27.617326], [-82.739122, 27.636909], [-82.738022, 27.706807], [-82.746223, 27.731306], [-82.753723, 27.736306], [-82.760923, 27.745205], [-82.770023, 27.767904], [-82.783124, 27.783804], [-82.790224, 27.791603], [-82.820433, 27.813742], [-82.797762, 28.187789], [-82.762643, 28.219013], [-82.76446, 28.220069], [-82.764103, 28.244345], [-82.759072, 28.25402], [-82.746188, 28.261192], [-82.732792, 28.291933], [-82.735463, 28.30039], [-82.73146, 28.325075], [-82.715822, 28.345501], [-82.706112, 28.368057], [-82.706322, 28.401325], [-82.697433, 28.420166], [-82.684137, 28.428019], [-82.677839, 28.434367], [-82.674787, 28.441956], [-82.680396, 28.457194], [-82.67241, 28.464746], [-82.665055, 28.484434], [-82.66447, 28.488788], [-82.66639, 28.49733], [-82.670146, 28.500769], [-82.675596, 28.656475], [-82.668034, 28.683285], [-82.668722, 28.695658], [-82.712373, 28.720921], [-82.698281, 28.75701], [-82.696906, 28.768009], [-82.70103, 28.797224], [-82.716497, 28.810285], [-82.730245, 28.850155], [-82.688657, 28.89518], [-82.688864, 28.905609], [-82.702618, 28.932955], [-82.708793, 28.935979], [-82.723861, 28.953506], [-82.735754, 28.973709], [-82.737872, 28.995703], [-82.760551, 28.993087], [-82.764055, 28.999707], [-82.759378, 29.006619], [-82.753513, 29.026496], [-82.759704, 29.054192], [-82.783328, 29.064619], [-82.780558, 29.07358], [-82.823659, 29.098902], [-82.809483, 29.10462], [-82.801166, 29.105103], [-82.799117, 29.110647], [-82.798876, 29.114504], [-82.805703, 29.129848], [-82.804736, 29.146624], [-82.827073, 29.158425], [-82.858179, 29.162275], [-82.887211, 29.161741], [-82.922613, 29.169769], [-82.932405, 29.167891], [-82.945302, 29.167821], [-82.974676, 29.17091], [-82.979522, 29.171817], [-82.987162, 29.180094], [-82.991653, 29.180664], [-82.996144, 29.178074], [-83.018212, 29.151417], [-83.056867, 29.146263], [-83.068249, 29.153135], [-83.060947, 29.170959], [-83.061162, 29.176113], [-83.065242, 29.184489], [-83.078986, 29.196944], [-83.087839, 29.21642], [-83.074734, 29.247975], [-83.077265, 29.255331], [-83.089013, 29.266502], [-83.176736, 29.31422], [-83.17826, 29.327916], [-83.176852, 29.329269], [-83.175518, 29.34469], [-83.189581, 29.363417], [-83.200702, 29.373855], [-83.202446, 29.394422], [-83.218075, 29.420492], [-83.240509, 29.433178], [-83.263965, 29.435806], [-83.272019, 29.432256], [-83.294747, 29.437923], [-83.307094, 29.459651], [-83.307828, 29.468861], [-83.311546, 29.475666], [-83.323214, 29.476789], [-83.33113, 29.475594], [-83.350067, 29.489358], [-83.401552, 29.523291], [-83.405256, 29.578319], [-83.405068, 29.59557], [-83.39948, 29.612956], [-83.404081, 29.640798], [-83.412768, 29.668485], [-83.414701, 29.670536], [-83.436259, 29.677389], [-83.444635, 29.677155], [-83.448194, 29.675254], [-83.455356, 29.676444], [-83.483143, 29.690478], [-83.566018, 29.761434], [-83.578955, 29.768378], [-83.584716, 29.77608], [-83.586089, 29.784644], [-83.583045, 29.787307], [-83.581903, 29.792063], [-83.585899, 29.811754], [-83.595493, 29.827984], [-83.605244, 29.836387], [-83.618568, 29.842336], [-83.63798, 29.886073], [-83.757249, 29.957943], [-83.788729, 29.976982], [-83.82869, 29.983187], [-83.845427, 29.998068], [-83.93151, 30.039068], [-83.933668, 30.041152], [-83.931879, 30.044175], [-83.933432, 30.046305], [-83.95968, 30.064943], [-83.991607, 30.08392], [-84.000716, 30.096209], [-84.024274, 30.103271], [-84.048715, 30.103208], [-84.06299, 30.101378], [-84.094725, 30.094964], [-84.10273, 30.093611], [-84.11384, 30.085478], [-84.124889, 30.090601], [-84.135683, 30.083018], [-84.157278, 30.072714], [-84.167881, 30.071422], [-84.179149, 30.073187], [-84.184493, 30.077254], [-84.182217, 30.082359], [-84.269363, 30.09766], [-84.272511, 30.092358], [-84.274003, 30.083079], [-84.270368, 30.075469], [-84.270792, 30.068094], [-84.277168, 30.060263], [-84.289727, 30.057197], [-84.297836, 30.057451], [-84.315344, 30.069492], [-84.342022, 30.063858], [-84.359986, 29.984739], [-84.3477, 29.984123], [-84.343041, 29.9751], [-84.342046, 29.967101], [-84.423335, 29.983354], [-84.429865, 29.982667], [-84.432958, 29.981292], [-84.432271, 29.972356], [-84.435708, 29.964107], [-84.433646, 29.962388], [-84.443652, 29.913785], [-84.451705, 29.929085], [-84.470323, 29.924524], [-84.494562, 29.913957], [-84.511996, 29.916574], [-84.535873, 29.910092], [-84.57744, 29.887828], [-84.603303, 29.876117], [-84.613154, 29.867984], [-84.647958, 29.847104], [-84.656318, 29.837943], [-84.65645, 29.834277], [-84.669728, 29.82891], [-84.683934, 29.831327], [-84.692053, 29.829059], [-84.877111, 29.772888], [-84.893992, 29.785176], [-84.90413, 29.786279], [-84.91511, 29.783303], [-84.920917, 29.772901], [-85.319215, 29.681494], [-85.343619, 29.672004], [-85.347711, 29.66719], [-85.344768, 29.654793], [-85.352615, 29.659787], [-85.369419, 29.681048], [-85.380303, 29.698485], [-85.397871, 29.740498], [-85.413983, 29.799865], [-85.417971, 29.828855], [-85.416548, 29.842628], [-85.413575, 29.85294], [-85.405815, 29.865817], [-85.392469, 29.870914], [-85.39874, 29.859267], [-85.405011, 29.830151], [-85.405907, 29.80193], [-85.395528, 29.762368], [-85.37796, 29.709621], [-85.3638, 29.693526], [-85.301331, 29.797117], [-85.487764, 29.961227], [-85.509148, 29.971466], [-85.541176, 29.995791], [-85.571907, 30.02644], [-85.58139, 30.037783], [-85.591048, 30.048874], [-85.601178, 30.056342], [-85.618254, 30.065481], [-85.637285, 30.073319], [-85.653251, 30.077839], [-85.69681, 30.09689], [-85.730054, 30.118153], [-85.74993, 30.136537], [-85.775405, 30.15629], [-85.811219, 30.17832], [-85.878138, 30.215619], [-85.9226, 30.238024], [-85.999937, 30.27078], [-86.089963, 30.303569], [-86.222561, 30.343585], [-86.2987, 30.363049], [-86.364175, 30.374524], [-86.412076, 30.380346], [-86.470849, 30.3839], [-86.50615, 30.3823], [-86.529067, 30.386896], [-86.632953, 30.396299], [-86.750906, 30.391881], [-86.850625, 30.380967], [-86.909679, 30.372423], [-87.155392, 30.327748], [-87.206254, 30.320943], [-87.267827, 30.31548], [-87.282787, 30.318744], [-87.295422, 30.323503], [-87.319518, 30.317814], [-87.350486, 30.313064], [-87.419859, 30.297128], [-87.518324, 30.280435], [-87.51838, 30.283901], [-87.50548, 30.287101], [-87.49998, 30.287901], [-87.452378, 30.300201], [-87.450078, 30.3111], [-87.455578, 30.3102], [-87.459578, 30.3083], [-87.462978, 30.3078], [-87.371169, 30.43049], [-87.368191, 30.433407], [-87.366591, 30.436648], [-87.366939, 30.44048], [-87.36868, 30.444631], [-87.370768, 30.446865], [-87.381176, 30.450097], [-87.391976, 30.451597], [-87.396877, 30.450597], [-87.399877, 30.450997], [-87.404677, 30.452897], [-87.407877, 30.456396], [-87.414677, 30.457296], [-87.425078, 30.465596], [-87.429578, 30.470596], [-87.430578, 30.476596], [-87.405874, 30.666616], [-87.407118, 30.671796], [-87.406561, 30.674019], [-87.406958, 30.675165], [-87.412739, 30.678055], [-87.419527, 30.679981], [-87.424883, 30.683374], [-87.430372, 30.688645], [-87.436021, 30.688668], [-87.439814, 30.690479], [-87.552051, 30.786254], [-87.552954, 30.786941], [-87.554838, 30.787125], [-87.559484, 30.790447], [-87.560068, 30.792258], [-87.564209, 30.796246], [-87.56814, 30.799088], [-87.572043, 30.800532], [-87.576849, 30.808163], [-87.581869, 30.812403], [-87.620922, 30.889923], [-87.622519, 30.89368], [-87.622203, 30.897508], [-87.620715, 30.89893], [-87.616013, 30.901453], [-87.614951, 30.904226], [-87.614209, 30.908536], [-87.611847, 30.914541], [-87.6102, 30.916628], [-87.608262, 30.9219], [-87.51952, 30.997586], [-87.480243, 30.998202], [-87.479703, 30.998197], [-87.478706, 30.998213], [-87.466879, 30.998178], [-87.466827, 30.998178], [-87.461783, 30.998201], [-87.461638, 30.998202], [-87.458658, 30.998386], [-87.455705, 30.998318], [-87.367842, 30.998292], [-87.364011, 30.998218], [-87.355656, 30.998244], [-87.333973, 30.998272], [-87.312183, 30.998435], [-87.30403, 30.998191], [-87.301567, 30.998434], [-87.290995, 30.998352], [-87.288905, 30.998345], [-87.265564, 30.998267], [-87.162614, 30.999055], [-87.140755, 30.999532], [-87.124969, 30.998802], [-87.118873, 30.999427], [-87.068633, 30.999143], [-87.064063, 30.999191], [-87.053737, 30.999131], [-87.039989, 30.999594], [-87.036366, 30.999348], [-87.027107, 30.999255], [-87.004359, 30.999316], [-86.998477, 30.998661], [-86.92781, 30.997704], [-86.888135, 30.997577], [-86.872989, 30.997631], [-86.831934, 30.997378], [-86.830497, 30.997401], [-86.785918, 30.996978], [-86.74524, 30.99629], [-86.728392, 30.996739], [-86.727293, 30.996882], [-86.725379, 30.996872], [-86.706261, 30.994703], [-86.678383, 30.994537], [-86.664681, 30.994534], [-86.567586, 30.995109], [-86.563436, 30.995223], [-86.519938, 30.993245], [-86.512834, 30.9937], [-86.49995, 30.99334], [-86.458319, 30.993998], [-86.454704, 30.993791], [-86.404912, 30.994049], [-86.391937, 30.994172], [-86.388647, 30.994181], [-86.374545, 30.994474], [-86.36927, 30.994477], [-86.364907, 30.994455], [-86.304596, 30.994029], [-86.289247, 30.993798], [-86.256448, 30.993853], [-86.238335, 30.99437], [-86.180232, 30.994005], [-86.175204, 30.993798], [-86.168979, 30.993706], [-86.162886, 30.993682], [-86.116918, 30.992917], [-86.056213, 30.993133], [-86.052462, 30.993247], [-86.035039, 30.99332], [-85.998643, 30.99287], [-85.893543, 30.993467], [-85.749932, 30.994837], [-85.749619, 30.995292], [-85.498272, 30.996928], [-85.243632, 31.000884], [-85.154452, 31.000835], [-85.152218, 31.000834], [-85.152085, 31.000888], [-85.145835, 31.000695], [-85.057534, 31.000585], [-85.054802, 31.000585], [-85.052088, 31.000585], [-85.031155, 31.000647], [-85.030107, 31.000653], [-85.027512, 31.00067], [-85.024108, 31.000681], [-85.002368, 31.000682], [-85.0019, 31.000681], [-85.001819, 30.997889], [-84.956125, 30.907587], [-84.952325, 30.902287], [-84.949625, 30.897387], [-84.942525, 30.888488], [-84.941325, 30.887688], [-84.939974, 30.886728], [-84.938087, 30.885627], [-84.936828, 30.884683], [-84.935413, 30.882481], [-84.93557, 30.878707], [-84.937615, 30.875876], [-84.938401, 30.873045], [-84.937772, 30.870528], [-84.935728, 30.86754], [-84.644815, 30.701992], [-84.606386, 30.699865], [-84.606249, 30.699872], [-84.53937, 30.696775], [-84.535042, 30.696523], [-84.474409, 30.692793], [-84.374905, 30.689794], [-84.28121, 30.685256], [-84.2499, 30.684145], [-84.124895, 30.678046], [-84.107699, 30.676818], [-84.057228, 30.674705], [-84.046605, 30.6742], [-84.04181, 30.673878], [-84.039707, 30.673819], [-84.007391, 30.672097], [-83.880317, 30.665807], [-83.88022, 30.665832], [-83.855216, 30.664412], [-83.820886, 30.662612], [-83.810536, 30.66188], [-83.676773, 30.654905], [-83.674058, 30.654747], [-83.611667, 30.651255], [-83.499876, 30.645671], [-83.448895, 30.64241], [-83.440021, 30.642023], [-83.429584, 30.641496], [-83.429477, 30.641519], [-83.390062, 30.639333], [-83.37946, 30.63868], [-83.341011, 30.636346], [-83.311647, 30.634577], [-83.309455, 30.634417], [-83.187391, 30.627223], [-83.174411, 30.626444], [-83.163309, 30.625895], [-83.15617, 30.625504], [-83.13137, 30.623583], [-82.878779, 30.609082], [-82.877259, 30.609024], [-82.698902, 30.598271], [-82.698618, 30.598232], [-82.689271, 30.597719], [-82.569237, 30.590965], [-82.565476, 30.590622], [-82.553159, 30.589934], [-82.545055, 30.589361], [-82.536233, 30.588885], [-82.524899, 30.588189], [-82.459544, 30.584272], [-82.374844, 30.579004], [-82.287343, 30.573458], [-82.2581, 30.571559], [-82.249841, 30.570863], [-82.214839, 30.568591], [-82.214385, 30.566958], [-82.218579, 30.564403], [-82.223025, 30.56321], [-82.227254, 30.561041], [-82.231916, 30.55627], [-82.235603, 30.544885], [-82.20987, 30.432818], [-82.210291, 30.42459], [-82.204151, 30.40133], [-82.19294, 30.378779], [-82.189847, 30.375938], [-82.183797, 30.373712], [-82.180018, 30.368625], [-82.171508, 30.359869], [-82.170054, 30.358929], [-82.165192, 30.358035], [-82.161757, 30.357851], [-82.158109, 30.359913], [-82.143282, 30.363393], [-82.116385, 30.367335], [-82.036203, 30.43846], [-82.030064, 30.444853], [-82.028212, 30.447396], [-82.025457, 30.457755], [-82.023734, 30.467289], [-82.017779, 30.475081], [-82.016982, 30.478779], [-82.017297, 30.487638], [-82.018222, 30.492085], [-82.015892, 30.495499], [-82.01477, 30.513009], [-82.015826, 30.518166], [-82.01699, 30.519358], [-82.018868, 30.523828], [-82.018361, 30.531184], [-82.013216, 30.550091], [-82.026941, 30.606153], [-82.027338, 30.606726], [-82.026541, 30.613303], [-82.028499, 30.621829], [-82.050432, 30.676266], [-82.041812, 30.692376], [-82.036426, 30.706585], [-82.037563, 30.71864], [-82.039154, 30.723178], [-82.04101, 30.72508], [-82.043795, 30.729641], [-82.041168, 30.734248], [-82.040026, 30.737548], [-82.039634, 30.747727], [-82.017917, 30.755263], [-82.01266, 30.761289], [-82.011597, 30.763122], [-82.017881, 30.775844], [-82.017051, 30.791657], [-82.007865, 30.792937], [-82.004973, 30.791744], [-81.994972, 30.786073], [-81.990855, 30.781611], [-81.988605, 30.780056], [-81.842058, 30.78712], [-81.840375, 30.786384], [-81.827014, 30.788933], [-81.808529, 30.790014], [-81.806652, 30.789683], [-81.792769, 30.784432], [-81.78435, 30.77359], [-81.782653, 30.769937], [-81.779171, 30.768062], [-81.775021, 30.76833], [-81.672824, 30.738935], [-81.670124, 30.740235], [-81.669324, 30.741335], [-81.668275, 30.744643], [-81.667336, 30.74566], [-81.664598, 30.746599], [-81.662173, 30.746521], [-81.656541, 30.745113], [-81.652123, 30.742435], [-81.651723, 30.740235], [-81.489537, 30.7261], [-81.487332, 30.726081], [-81.483786, 30.723891], [-81.475754, 30.714754], [-81.472597, 30.713312], [-81.464465, 30.711045], [-81.459978, 30.710434], [-81.448718, 30.709353], [-81.444124, 30.709714], [-81.432725, 30.703017], [-81.443099, 30.600938], [-81.442564, 30.555189], [-81.434064, 30.522569], [-81.447087, 30.503679], [-81.440108, 30.497678], [-81.42601, 30.496739], [-81.410809, 30.482039], [-81.407008, 30.42204], [-81.397422, 30.400626], [-81.39736, 30.396967], [-81.389789, 30.397422], [-81.397067, 30.379511], [-81.396407, 30.34004], [-81.391606, 30.303441], [-81.385505, 30.273841], [-81.355591, 30.162563], [-81.308978, 29.96944], [-81.295268, 29.928614], [-81.288955, 29.91518], [-81.27654, 29.90046], [-81.270442, 29.883106], [-81.264693, 29.858212], [-81.263396, 29.820663], [-81.256711, 29.784693], [-81.240924, 29.739218], [-81.229015, 29.714693], [-81.211565, 29.667085], [-81.163581, 29.55529], [-81.123896, 29.474465], [-81.046678, 29.307856], [-80.966176, 29.14796], [-80.944376, 29.110861], [-80.907275, 29.064262], [-80.893675, 29.036163], [-80.878275, 29.010563], [-80.787021, 28.875266], [-80.709725, 28.756692], [-80.647288, 28.677875], [-80.61679, 28.634561], [-80.583884, 28.597705], [-80.574868, 28.585166], [-80.567361, 28.562353], [-80.560973, 28.530736], [-80.536115, 28.478647], [-80.525094, 28.459454], [-80.526732, 28.451705], [-80.562877, 28.437779], [-80.574136, 28.427764], [-80.587813, 28.410856], [-80.596174, 28.390682], [-80.603374, 28.363983], [-80.606874, 28.336484], [-80.608074, 28.311285], [-80.604214, 28.257733], [-80.589975, 28.17799], [-80.566432, 28.09563], [-80.547675, 28.048795], [-80.508871, 27.970477], [-80.446973, 27.861954], [-80.447179, 27.859731], [-80.383695, 27.740045], [-80.351717, 27.642623], [-80.350553, 27.628361], [-80.34437, 27.616226], [-80.330956, 27.597541], [-80.324699, 27.569178], [-80.311757, 27.524625], [-80.30117, 27.500314], [-80.293171, 27.500314], [-80.265535, 27.420542], [-80.253665, 27.37979], [-80.233538, 27.341307], [-80.226753, 27.322736], [-80.19309, 27.249546], [-80.16147, 27.192814], [-80.153375, 27.169308], [-80.159554, 27.163325], [-80.14982, 27.143557], [-80.138605, 27.111517], [-80.116772, 27.072397], [-80.093909, 27.018587], [-80.046263, 26.859238], [-80.031362, 26.796339], [-80.03212, 26.77153], [-80.036362, 26.77124], [-80.037462, 26.76634], [-80.032862, 26.715242], [-80.032862, 26.700842], [-80.035763, 26.676043], [-80.035363, 26.612346], [-80.038863, 26.569347], [-80.050363, 26.509549], [-80.060564, 26.444652], [-80.070564, 26.336455], [-80.072264, 26.335356], [-80.075264, 26.318656], [-80.079865, 26.264358], [-80.085565, 26.249259], [-80.089365, 26.231859], [-80.101366, 26.147762], [-80.105266, 26.096264], [-80.109566, 26.087165], [-80.117778, 25.986369], [-80.117904, 25.915772], [-80.12087, 25.883152], [-80.119684, 25.841043], [-80.122056, 25.817913], [-80.127394, 25.791224], [-80.127987, 25.772245], [-80.137476, 25.750301], [-80.144, 25.740812], [-80.152896, 25.702855], [-80.154082, 25.683283], [-80.152303, 25.676759], [-80.154972, 25.66549], [-80.160903, 25.664897], [-80.176916, 25.685062], [-80.170392, 25.710565], [-80.250459, 25.688028], [-80.265879, 25.658373], [-80.267065, 25.651849], [-80.277147, 25.637022], [-80.288416, 25.630498], [-80.296719, 25.622195], [-80.301464, 25.613299], [-80.305615, 25.593134], [-80.305615, 25.575342], [-80.302057, 25.567632], [-80.313918, 25.539164], [-80.324594, 25.535605], [-80.328746, 25.53264], [-80.339421, 25.499427], [-80.339421, 25.478669], [-80.337049, 25.465621], [-80.328152, 25.443084], [-80.320442, 25.437153], [-80.326373, 25.422919], [-80.32578, 25.39801], [-80.320442, 25.391486], [-80.31036, 25.389707], [-80.306801, 25.384369], [-80.31036, 25.3731], [-80.335269, 25.338701], [-80.418872, 25.235532], [-80.432621, 25.235876], [-80.442588, 25.24275], [-80.462833, 25.236247], [-80.467824, 25.23254], [-80.469842, 25.230443], [-80.481136, 25.226046], [-80.4887, 25.226936], [-80.49315, 25.225157], [-80.49315, 25.218482], [-80.485865, 25.211281], [-80.488035, 25.206942], [-80.495341, 25.199463], [-80.498644, 25.20015], [-80.645876, 25.189005], [-80.655331, 25.184556], [-80.659224, 25.17955], [-80.654219, 25.177881], [-80.640275, 25.17662], [-80.645822, 25.174029], [-80.649251, 25.168708], [-80.648657, 25.157859], [-80.651994, 25.151185], [-80.650326, 25.147292], [-80.809436, 25.178064], [-80.815183, 25.164959], [-80.82653, 25.160478], [-80.830034, 25.168094], [-80.838227, 25.174791], [-80.846395, 25.17706], [-80.858167, 25.176576], [-80.87546, 25.174321], [-80.900066, 25.162034], [-80.901617, 25.153803], [-80.999176, 25.124222], [-81.009598, 25.125403], [-81.022989, 25.129393], [-81.050505, 25.128273], [-81.079859, 25.118797], [-81.094524, 25.127054], [-81.111943, 25.14547], [-81.120616, 25.152302], [-81.133567, 25.156295], [-81.141024, 25.163868], [-81.155481, 25.208098], [-81.172044, 25.222276], [-81.170907, 25.245857], [-81.168307, 25.253178], [-81.16207, 25.289833], [-81.159293, 25.298595], [-81.1523, 25.305543], [-81.148915, 25.318067], [-81.151916, 25.324766], [-81.148103, 25.332793], [-81.140099, 25.341117], [-81.133913, 25.342996], [-81.12141, 25.33875], [-81.118208, 25.34522], [-81.117265, 25.354953], [-81.128492, 25.380511], [-81.168652, 25.463848], [-81.179406, 25.475427], [-81.191924, 25.484745], [-81.208201, 25.504937], [-81.210149, 25.516888], [-81.203175, 25.53416], [-81.204389, 25.538908], [-81.209321, 25.548611], [-81.225557, 25.55847], [-81.232705, 25.573366], [-81.233051, 25.586587], [-81.328935, 25.717233], [-81.335037, 25.715649], [-81.346078, 25.721473], [-81.345972, 25.736536], [-81.343984, 25.747668], [-81.346767, 25.754029], [-81.355116, 25.76039], [-81.359489, 25.766354], [-81.361875, 25.772715], [-81.344779, 25.782257], [-81.501027, 25.884037], [-81.508979, 25.884037], [-81.512955, 25.886423], [-81.511762, 25.89676], [-81.515738, 25.899941], [-81.527665, 25.901531], [-81.541183, 25.900338], [-81.577363, 25.889206], [-81.584519, 25.888808], [-81.614735, 25.893977], [-81.678287, 25.845301], [-81.6848, 25.847205], [-81.68954, 25.85271], [-81.713172, 25.897568], [-81.717687, 25.902039], [-81.727086, 25.907207], [-81.73195, 25.931506], [-81.738118, 25.942009], [-81.745579, 25.949643], [-81.749724, 25.960463], [-81.747834, 25.994273], [-81.750668, 25.998425], [-81.757463, 26.000374], [-81.762439, 26.00607], [-81.801663, 26.088227], [-81.808833, 26.152246], [-81.81461, 26.173167], [-81.81681, 26.207166], [-81.820675, 26.236735], [-81.833142, 26.294518], [-81.844555, 26.327712], [-81.868983, 26.378648], [-81.90191, 26.410859], [-81.90271, 26.416159], [-81.91171, 26.427158], [-81.923611, 26.436658], [-81.938411, 26.445058], [-81.956611, 26.452358], [-81.964212, 26.457957], [-81.967112, 26.462857], [-81.966212, 26.465057], [-82.024604, 26.512677], [-82.043577, 26.519577], [-82.06715, 26.513252], [-82.07175, 26.492554], [-82.094748, 26.48393], [-82.105672, 26.48393], [-82.111996, 26.54085], [-82.118896, 26.560973], [-82.122345, 26.579371], [-82.137869, 26.637441], [-82.149943, 26.654115], [-82.181565, 26.681712], [-82.17984, 26.696661], [-82.173516, 26.701836], [-82.151668, 26.704136], [-82.139019, 26.702986], [-82.125795, 26.699536], [-82.118896, 26.690912], [-82.106247, 26.667339], [-82.058526, 26.838674], [-82.056801, 26.858797], [-82.059101, 26.876621], [-82.066575, 26.88237], [-82.090723, 26.888694], [-82.093023, 26.906518], [-82.090148, 26.923191], [-82.083249, 26.927791], [-82.067725, 26.927791], [-82.061976, 26.931241], [-82.221812, 26.77198], [-82.233311, 26.784054], [-82.241935, 26.774279], [-82.251134, 26.755881], [-82.259867, 26.717398], [-82.263804, 26.725644], [-82.264682, 26.756836], [-82.269499, 26.784674], [-82.289086, 26.827784], [-82.301736, 26.841588], [-82.351649, 26.908384], [-82.400618, 26.984937], [-82.419218, 27.020736], [-82.445718, 27.060634], [-82.460319, 27.099933], [-82.465319, 27.110732], [-82.46889, 27.113612], [-82.477019, 27.141231], [-82.512319, 27.207528], [-82.539719, 27.254326], [-82.54512, 27.261026], [-82.55902, 27.268826], [-82.569754, 27.279452], [-82.569248, 27.298588], [-82.57602, 27.309324], [-82.597629, 27.335754], [-82.623863, 27.362206], [-82.642821, 27.38972], [-82.675121, 27.424318], [-82.691821, 27.437218], [-82.691004, 27.444331], [-82.707821, 27.487615], [-82.714521, 27.500415], [-82.514265, 27.705588], [-82.494891, 27.718963], [-82.482449, 27.719886], [-82.477638, 27.723004], [-82.255777, 26.703437], [-82.255159, 26.70816], [-82.196514, 26.559823], [-82.187315, 26.527626], [-82.201402, 26.55631], [-82.205523, 26.566536], [-82.222131, 26.590402], [-80.450399, 25.088751], [-80.444887, 25.092966], [-80.433575, 25.106317], [-80.433499, 25.114665], [-80.439403, 25.128453], [-80.426786, 25.127297], [-80.289602, 25.325061], [-80.275961, 25.344039], [-80.256982, 25.361239], [-80.25461, 25.38081], [-80.251052, 25.391486], [-80.246307, 25.398603], [-80.226142, 25.406313], [-80.219025, 25.411058], [-80.21428, 25.416988], [-80.20657, 25.434188], [-80.537995, 24.990244], [-80.565831, 24.958155], [-80.571668, 24.953659], [-80.588272, 24.951153], [-80.596073, 24.948173], [-80.611693, 24.93842], [-80.635571, 24.913003], [-80.658045, 24.898314], [-80.657199, 24.892579], [-80.657543, 24.891204], [-80.658917, 24.890517], [-80.661667, 24.892579], [-80.663386, 24.89361], [-80.66476, 24.89361], [-80.690803, 24.881116], [-80.706356, 24.867232], [-80.711849, 24.863323], [-80.623866, 24.931236], [-80.622896, 24.935587], [-80.624172, 24.939058], [-80.822342, 24.812629], [-80.846191, 24.802968], [-80.850338, 24.8026], [-80.850866, 24.803701], [-80.846142, 24.807488], [-80.830158, 24.81428], [-80.814551, 24.827953], [-80.89054, 24.791678], [-80.884572, 24.791561], [-80.88402, 24.790414], [-80.892649, 24.785991], [-80.906874, 24.783744], [-80.89054, 24.791678], [-80.909954, 24.781154], [-80.906288, 24.769867], [-80.912042, 24.76505], [-80.938543, 24.767535], [-81.015933, 24.719881], [-81.023794, 24.716901], [-81.028616, 24.720618], [-81.032447, 24.727323], [-81.03429, 24.727341], [-81.064554, 24.715453], [-81.071034, 24.711722], [-81.075855, 24.704266], [-81.078716, 24.696557], [-81.078439, 24.692382], [-81.249799, 24.673357], [-81.246095, 24.675832], [-81.243232, 24.673998], [-81.244761, 24.669202], [-81.281778, 24.65375], [-81.278312, 24.660448], [-81.260006, 24.674848], [-81.249799, 24.673357], [-81.582923, 24.658732], [-81.580534, 24.66914], [-81.562917, 24.692912], [-81.55761, 24.692488], [-81.542116, 24.681026], [-81.535323, 24.67954], [-81.51898, 24.687818], [-81.516433, 24.700341], [-81.5124, 24.703737], [-81.490962, 24.710105], [-81.476642, 24.711244], [-81.474186, 24.706332], [-81.469275, 24.704286], [-81.459043, 24.707355], [-81.454132, 24.710834], [-81.451881, 24.714518], [-81.4527, 24.736209], [-81.456588, 24.740097], [-81.451267, 24.747464], [-81.319282, 24.701238], [-81.314787, 24.691764], [-81.502992, 24.660877], [-81.674694, 24.564359], [-81.685278, 24.558739], [-81.691575, 24.559886], [-81.732511, 24.556423], [-81.765993, 24.552103], [-81.786157, 24.54658], [-81.810333, 24.544701], [-81.81289, 24.546468], [-81.814446, 24.56358], [-81.811386, 24.56975], [-81.800676, 24.570989], [-81.801378, 24.588963], [-81.798797, 24.595676], [-81.795182, 24.596192], [-81.790808, 24.585836], [-81.773808, 24.584977], [-81.748071, 24.590199], [-81.739241, 24.589973], [-81.734573, 24.584148], [-82.158653, 24.547716], [-82.164009, 24.550095], [-82.166382, 24.55307], [-82.166382, 24.557829], [-82.164604, 24.564371], [-82.160439, 24.567942], [-82.157463, 24.567942], [-82.155678, 24.564966], [-82.157463, 24.561993], [-82.158653, 24.557829], [-82.156868, 24.556044], [-82.147346, 24.555449], [-82.110466, 24.572701], [-82.111061, 24.579838], [-82.115822, 24.582813], [-82.122368, 24.584597], [-82.130096, 24.586382], [-82.139618, 24.585787], [-82.143784, 24.584597], [-82.146164, 24.587572], [-84.604736, 29.810293], [-84.573975, 29.830572]]

FLORIDA_LIGHTHOUSES = [
    ["Alligator Reef", 136, 1873, -80.6183333333333, 24.8516666666667, "3.5 Miles from Islamorada"],
    ["Amelia Island", 107, 1838, -81.4424444444444, 30.6731833333333, "Fernandina Beach"],
    ["American Shoal", 109, 1880, -81.52, 24.525, "15 Miles from Looe Key"],
    ["Anclote Key", 110, 1887, -82.84465, 28.166975, "Tarpon Springs"],
    ["Cape Canaveral", 137, 1868, -80.54345, 28.46035, "Cap Canaveral Space Force Station"],
    ["Cape Florida", 95, 1825, -80.1559638888889, 25.6665888888889, "Key Biscayne"],
    ["Cape San Blas", 101, 1848, -85.3563111111111, 29.671225, "Port St. Joe"],
    ["Cape St. George", 72, 2008, -84.8625555555555, 29.6628055555556, "St. George Island"],
    ["Carysfort Reef", 100, 1852, -80.2116666666667, 25.2216666666667, "Carysfort Reef"],
    ["Cedar Key", 75, 1854, -83.0652777777778, 29.0964805555556, "Seahorse Key, FL"],
    ["Crooked River", 115, 1895, -84.7011111111111, 29.8275, "Crooked River, FL"],
    ["Egmont Key", 85, 1848, -82.7608333333333, 27.6008333333333, "Egmont Key, FL"],
    ["Fowey Rocks", 110, 1878, -80.0967333333333, 25.590625, "Offshore from Key Biscayne"],
    ["Garden Key", 70, 1826, -82.8722222222222, 24.6280555555556, "West of Key West"],
    ["Gasparilla Island", 105, 1932, -82.2608333333333, 26.7172222222222, "Boca Grande"],
    ["Hillsboro Inlet", 136, 1907, -80.0808333333333, 26.2591666666667, "Pampano Beach"],
    ["Jupiter Inlet", 146, 1860, -80.0819444444444, 26.9486111111111, "Jupiter, FL"],
    ["Key West", 91, 1826, -81.8007, 24.5506, "Key West, FL"],
    ["Loggerhead Key", 151, 1858, -82.92, 24.6333333333333, "Loggerhead Key"],
    ["Pensacola", 191, 1824, -87.3080555555556, 30.3463888888889, "Pensacola, FL"],
    ["Ponce de Leon Inlet", 159, 1887, -80.9280555555556, 29.0802777777778, "Ponce Inlet, FL"],
    ["Port Boca Grande", 41, 1890, -82.2608333333333, 26.7172222222222, "Boca Grande, FL"],
    ["Sand Key", 109, 1827, -81.8775055555555, 24.4539388888889, "Offshore from Key West"],
    ["Sanibel Island", 98, 1884, -82.0142555555556, 26.4529194444444, "Sanibel, FL"],
    ["Sombrero Key", 142, 1858, -81.1116055555556, 24.6279055555556, "Offshore from Marathon, FL"],
    ["St. Augustine", 161, 1874, -81.2886111111111, 29.8855555555556, "St. Augustine, FL"],
    ["St. Johns", 83, 1954, -81.3980555555556, 30.3861111111111, "Naval Station Mayport"],
    ["St. Marks", 82, 1842, -84.18, 30.0719444444444, "St. Marks, FL"],
    ["Tennessee Reef", 49, 1933, -80.7823527777778, 24.7460777777778, "Offshore from Layton, FL"],
]

MAP_CITIES_COLOR = "#f00"
VISITED_COLOR = "FFFF00"  #"#9b870c"
UNVISITED_COLOR = "565a06"  #"#f5e31d"
BRIGHT_OUTLINE_COLOR = "#fff"
DULL_OUTLINE_COLOR = "#111"

CONFIG_PATTERN_LIGHTHOUSES = "Item_%s_%s"

def main(config):
    isDisplayCities = config.bool("displayMajorCities")
    isDisplayPicks = config.bool("pickVisits")
    isDisplayArt = config.bool("displayArtwork")

    #Get the map area based on the points of the map
    map_area = define_map_area(FLORIDA_MAP)
    #map_points = get_map_points(FLORIDA_MAP, map_area, MAP_PIXEL_SIZE)

    # get just the coordinates from the Florida Lighthouses
    col_indexes = [3, 4]
    lighthouse_coordinates = [[row[col] for col in col_indexes] for row in FLORIDA_LIGHTHOUSES]

    #Just in case lighthouses expand the map area
    map_area = define_map_area(lighthouse_coordinates, map_area[0], map_area[1])

    map_items = []

    #Image Background
    if isDisplayArt:
        map_items.append(render.Padding(render.Image(src = LIGHTHOUSE_GIF), (0, 0, 0, 0)))

    #Display Map
    map_outline_color = BRIGHT_OUTLINE_COLOR
    if isDisplayArt:
        map_outline_color = DULL_OUTLINE_COLOR

    map_items = append_items_to_render(map_items, get_map_points(FLORIDA_MAP, map_area, MAP_PIXEL_SIZE), map_outline_color)

    #Major Cities: Orlando, Tallahasse, Miami, Jacksonville, Tampa, Ft. Myers, Pensacola
    if isDisplayCities:
        map_items = append_items_to_render(map_items, get_map_points([[-81.29937, 28.4162], [-84.25342, 30.4551], [-80.20862, 25.7752], [-81.6616, 30.3369], [-82.4629, 28.1259], [-81.83182, 26.6196], [-87.1895, 30.4433]], map_area, MAP_PIXEL_SIZE), MAP_CITIES_COLOR)

    #All Lighthouses
    map_items = append_items_to_render(map_items, get_map_points(lighthouse_coordinates, map_area, MAP_PIXEL_SIZE), UNVISITED_COLOR)

    #Visited Lighthouses
    if isDisplayPicks:
        map_items = append_items_to_render(map_items, get_map_points(lighthouse_coordinates, map_area, MAP_PIXEL_SIZE, config), VISITED_COLOR)

    return render.Root(
        render.Stack(
            map_items,
        ),
    )

def define_map_area(map_coordinates, longitude_range = [], latitude_range = []):
    if not longitude_range:
        longitude_range = [map_coordinates[0][0], map_coordinates[0][0]]

    if not latitude_range:
        latitude_range = [map_coordinates[0][1], map_coordinates[0][1]]

    #find extremes
    for dot in map_coordinates:
        if (dot[0] < longitude_range[0]):
            longitude_range[0] = dot[0]
        if (dot[0] > longitude_range[1]):
            longitude_range[1] = dot[0]
        if (dot[1] < latitude_range[0]):
            latitude_range[0] = dot[1]
        if (dot[1] > latitude_range[1]):
            latitude_range[1] = dot[1]

    return [longitude_range, latitude_range]

def get_map_points(map_coordinates, map_area, pixel_area, config = []):
    map_array = [[0 for j in range(pixel_area[1])] for i in range(pixel_area[0])]

    for point in map_coordinates:
        x = int(math.round(abs(map_area[0][0] - point[0]) / abs(map_area[0][0] - map_area[0][1]) * (pixel_area[0] - 1)))
        y = pixel_area[1] - 1 - int(math.round(abs(map_area[1][0] - point[1]) / abs(map_area[1][0] - map_area[1][1]) * (pixel_area[1] - 1)))

        if map_array[x][y] == 0:
            if config:
                if config.bool(CONFIG_PATTERN_LIGHTHOUSES % (point[0], point[1])):
                    map_array[x][y] = 1
            else:
                map_array[x][y] = 1

    return map_array

def append_items_to_render(children, points, color):
    r = -1
    c = 0
    for row in points:
        r = r + 1
        c = 0
        for item in row:
            if (item > 0):
                children.append(render.Padding(render.Circle(diameter = 1, color = color), (r, c, 0, 0)))
            c = c + 1

    return children

def get_lighthouses(type):
    # default
    items = sorted(FLORIDA_LIGHTHOUSES, key = lambda x: x[0])
    icon = "towerCell"

    if type == "true":
        return [
            schema.Toggle(id = CONFIG_PATTERN_LIGHTHOUSES % (item[3], item[4]), name = item[0], desc = "%s" % item[5], icon = icon, default = False)
            for item in items
        ]
    else:
        return []


def get_schema():
    return schema.Schema(
        version = "1",
        fields = [
            schema.Toggle(
                id = "displayArtwork",
                name = "Display Background Image?",
                desc = "Display Background Image?",
                icon = "photoFilm",
                default = True,
            ),
            schema.Toggle(
                id = "displayMajorCities",
                name = "Display Cities?",
                desc = "Display major cities?",
                icon = "city",
                default = False,
            ),
            schema.Toggle(
                id = "pickVisits",
                name = "Highlight?",
                desc = "Highlight selected lighthouses?",
                icon = "highlighter",  #, towerCell, towerObservation, toggleOff, towerBroadcast
                default = True
            ),
            schema.Generated(
                id = "lighthouseList",
                source = "pickVisits", 
                handler = get_lighthouses,
            ),
        ],
    )
