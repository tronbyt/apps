<!DOCTYPE html>
<html>
<head>
<title>Trace Cursive Letters in 32x32 Grid</title>

<!-- Load Dancing Script Google Font -->
<link href="https://fonts.googleapis.com/css2?family=Dancing+Script&display=swap" rel="stylesheet">

<style>
  canvas {
    border: 1px solid black;
    cursor: crosshair;
  }
</style>
</head>
<body>

Enter a letter to trace:
<input type="text" id="letterInput" maxlength="1" value="a">
<button id="setLetter">Set Background Letter</button>
<br><br>

<canvas id="canvas" width="320" height="320"></canvas>
<br>
<button id="export">Export Coordinates</button>
<button id="clear">Clear Drawing</button>

<script>
const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");

let coords = [];
let drawing = false;
let lastX = null;
let lastY = null;

/* =========================================================
   STANDARD REFERENCE POINTS (32x32 logical grid)
   ========================================================= */
START_POINT = [2, 24]
END_POINT   = [20, 24]  

/* =========================================================
   DRAW START / END POINTS
   ========================================================= */
function drawReferencePoints() {
  ctx.fillStyle = "rgba(120,120,120,0.6)";

  // START_POINT
  ctx.beginPath();
  ctx.arc(
    START_POINT[0] * 10 + 5,
    START_POINT[1] * 10 + 5,
    4,
    0,
    Math.PI * 2
  );
  ctx.fill();

  // END_POINT
  ctx.beginPath();
  ctx.arc(
    END_POINT[0] * 10 + 5,
    END_POINT[1] * 10 + 5,
    4,
    0,
    Math.PI * 2
  );
  ctx.fill();
}

/* =========================================================
   DRAW BACKGROUND LETTER
   ========================================================= */
function drawLetter(char){
  ctx.clearRect(0, 0, canvas.width, canvas.height);

  drawReferencePoints();

  const padding = 2;
  const scaleFactor = (canvas.width - padding * 2 * 10) / 32;
  const fontSize = 32 * scaleFactor;

  ctx.font = `${fontSize}px 'Dancing Script'`;
  ctx.textAlign = "center";
  ctx.textBaseline = "middle";
  ctx.fillStyle = "rgba(0,0,0,0.2)";
  ctx.fillText(char, canvas.width / 2, canvas.height / 2);
}

/* =========================================================
   RECORD DRAWN PIXELS
   ========================================================= */
function addPixel(x, y){
  if (!coords.some(p => p[0] === x && p[1] === y)) {
    coords.push([x, y]);
    ctx.fillStyle = "black";
    ctx.fillRect(x * 10, y * 10, 10, 10);
  }
}

function drawLine(x0, y0, x1, y1){
  const dx = Math.abs(x1 - x0), sx = x0 < x1 ? 1 : -1;
  const dy = Math.abs(y1 - y0), sy = y0 < y1 ? 1 : -1;
  let err = dx - dy;

  while (true) {
    addPixel(x0, y0);
    if (x0 === x1 && y0 === y1) break;
    const e2 = 2 * err;
    if (e2 > -dy) { err -= dy; x0 += sx; }
    if (e2 <  dx) { err += dx; y0 += sy; }
  }
}

/* =========================================================
   MOUSE EVENTS
   ========================================================= */
canvas.addEventListener("mousedown", () => drawing = true);

canvas.addEventListener("mouseup", () => {
  drawing = false;
  lastX = lastY = null;
});

canvas.addEventListener("mousemove", (e) => {
  if (!drawing) return;

  const x = Math.floor(e.offsetX / 10);
  const y = Math.floor(e.offsetY / 10);

  if (lastX !== null && lastY !== null) {
    drawLine(lastX, lastY, x, y);
  } else {
    addPixel(x, y);
  }

  lastX = x;
  lastY = y;
});

/* =========================================================
   UI CONTROLS
   ========================================================= */
document.getElementById("setLetter").addEventListener("click", () => {
  const char = document.getElementById("letterInput").value || "a";
  drawLetter(char);
  coords = [];
});

document.getElementById("export").addEventListener("click", () => {
  console.log(JSON.stringify(coords));
});

document.getElementById("clear").addEventListener("click", () => {
  const char = document.getElementById("letterInput").value || "a";
  drawLetter(char);
  coords = [];
  lastX = lastY = null;
});

/* =========================================================
   INIT
   ========================================================= */
drawLetter("a");
</script>

</body>
</html>
